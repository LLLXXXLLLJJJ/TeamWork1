<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>Justified Nav Template for Bootstrap</title>
    <link href="/css/bootstrap.min.css" rel="stylesheet"/>

    <link href="/css/font-awesome.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700'
          rel='stylesheet' type='text/css'>

    <link href="/css/animate.css" rel="stylesheet">
    <link href="/css/bootsnav.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css"
          href="/css/htmleaf-demo.css">
    <link href="/css/overwrite.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/color.css" rel="stylesheet">
    <link href="/css/chooseprefer.css" rel="stylesheet">

    <style type="text/css">
        .container h1 {
            font-size: 20px;
        }

        .caption {
            text-align: center;
        }

        .caption h3 {
            font-size: 14px;
        }

        #carousel-example-generic img {
            width: 100%;
        }

        #header_info a {
            color: #C9C9C9;
        }

        #header_info a:hover {
            color: #FFF;
            text-decoration: none;
        }
    </style>


</head>

<body id="home">
<div id="header" th:replace="head::header"></div>

<!-- Start Navigation -->
<div id="headerSearch" th:replace="head-search::headerSearch"></div>
<!-- End Navigation -->
<div style="margin-top: 20px"></div>

<div class="clearfix"></div>

<div class="container">
    <div id="carousel-example-generic" class="carousel slide"
         data-ride="carousel">
        <!-- Indicators -->
        <ol class="carousel-indicators">
            <li data-target="#carousel-example-generic" data-slide-to="0"
                class="active"></li>
            <li data-target="#carousel-example-generic" data-slide-to="1"></li>
            <li data-target="#carousel-example-generic" data-slide-to="2"></li>
        </ol>

        <!-- Wrapper for slides -->
        <div class="carousel-inner" role="listbox">
            <div class="item active">
                <img src="/images/img_fjords_wide.jpg" alt="...">
                <div class="carousel-caption">第一个商品</div>
            </div>
            <div class="item">
                <img src="/images/img_nature_wide.jpg" alt="...">
                <div class="carousel-caption">第二个商品</div>
            </div>
            <div class="item">
                <img src="/images/img_mountains_wide.jpg" alt="...">
                <div class="carousel-caption">第三个商品</div>
            </div>
        </div>

        <!-- Controls -->
        <a class="left carousel-control" href="#carousel-example-generic"
           role="button" data-slide="prev"> <span
                class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a> <a class="right carousel-control" href="#carousel-example-generic"
                role="button" data-slide="next"> <span
            class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
    </div>
</div>

<div class="container">
    <h1>热门商品</h1>
    <div class="row">
<!--        <c:forEach items="${hotGoods}" var="hg" varStatus="status" >-->
        <div class="col-sm-6 col-md-4" th:each="hg:${session.hotGoods}">
            <div class="thumbnail goods-item">
                <a th:href="@{'/home/productView/'+${hg.id}}">
                    <img th:src="@{'/images/cover_picture/1005000/'+${hg.categoryId}+'/'+${hg.id}+'/'+${hg.url}}"  alt="...">
                </a>
                <div class="caption div-desc" id="${hg.id}">
                    <h3 th:text="${hg.goodsName}">商品名称</h3>
                    <p style="font-size:12px; color:dimgray" th:text="${hg.goodsIntroduce}">商品描述</p>
                    <p style="color:red">&yen;[[${hg.goodsPrice}]]</p>
                    <p>
                        <button type="button" class="btn btn-danger cart-buy" th:goodsId="${hg.id}">立即购买</button>
                        <button type="button" class="btn btn-default cart-add" th:goodsId="${hg.id}">加购物车</button>
                    </p>
                </div>
            </div>
        </div>
<!--        </c:forEach>-->
    </div>


    <!-- Jumbotron -->
    <div>
        <h1>新品推荐</h1>
        <div class="row">
<!--            <% for(Goods4List ng:(List<Goods4List>)request.getAttribute("newsGoods")) {%>-->
            <div class="col-sm-6 col-md-4">
                <div class="thumbnail">
                    <a href="/home/productView/<%=ng.getId()%>">
                        <img src="/images/cover_picture/<%=ng.getCategory().getParentId()%>/<%=ng.getCategoryId()%>/<%=ng.getId()%>/<%=ng.getUrl()%>" alt="...">
                    </a>
                    <div class="caption">
                        <h3><%=ng.getName()%></h3>
                        <p style="font-size:12px; color:dimgray"><%=ng.getDescription()%></p>
                        <p style="color:red">&yen;<%=ng.getPrice()%></p>
                        <p>
                            <button type="button" class="btn btn-danger cart-buy" >立即购买</button>
                            <button type="button" class="btn btn-default cart-add">加购物车</button>
                        </p>
                    </div>
                </div>
            </div>
<!--            <%}%>-->
            <!--
            <div class="col-sm-6 col-md-4">
                <div class="thumbnail">
                    <img src="/images/iphone.png" alt="...">
                    <div class="caption">
                        <h3>Thumbnail label</h3>
                        <p>...</p>
                        <p>
                            <a href="#" class="btn btn-danger" role="button">Button</a> <a
                                href="#" class="btn btn-default" role="button">Button</a>
                        </p>
                    </div>
                </div>

            </div>
            <div class="col-sm-6 col-md-4">
                <div class="thumbnail">
                    <img src="/images/iphone.png" alt="...">
                    <div class="caption">
                        <h3>Thumbnail label</h3>
                        <p>...</p>
                        <p>
                            <a href="#" class="btn btn-danger" role="button">Button</a> <a
                                href="#" class="btn btn-default" role="button">Button</a>
                        </p>
                    </div>
                </div>

            </div>
            -->
        </div>
    </div>

    <div th:if="${not #lists.isEmpty(session.personalGoods)}" id="recommendation">
        <h1>猜你喜欢</h1>
        <div class="col-sm-6 col-md-4 recomendation" th:each="ng:${session.personalGoods}">
            <div class="thumbnail goods-item">
                <a th:href="@{'/home/productView/'+${ng.id}}">
                    <img th:src="@{'/images/cover_picture/1005000/'+${ng.categoryId}+'/'+${ng.id}+'/'+${ng.url}}"  alt="...">
                </a>
                <div class="caption div-desc" id="${ng.id}">
                    <h3 th:text="${ng.goodsName}">商品名称</h3>
                    <p style="font-size:12px; color:dimgray" th:text="${ng.goodsIntroduce}">商品描述</p>
                    <p style="color:red">&yen;[[${ng.goodsPrice}]]</p>
                    <p>
                        <button type="button" class="btn btn-danger cart-buy" th:goodsId="${ng.id}">立即购买</button>
                        <button type="button" class="btn btn-default cart-add" th:goodsId="${ng.id}">加购物车</button>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div style="clear:both;"></div>

    <!-- Site footer -->
    <footer class="footer">
        <p>&copy; 2016 Company, Inc.</p>
    </footer>

</div>
<!-- /container -->

<script src="/js/jquery.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="/js/bootstrap.js"></script>
<script type="text/javascript" src="/js/bootsnav.js"></script>
<script type="text/javascript" src="/js/login.js"></script>
<script type="text/javascript">
    $('.cart-buy').click(function(event) {
        console.log($(event.target).attr("goodsId"));
        var goodsId=$(event.target).attr("goodsId")
        //检查用户是否登录
            $.ajax({
                type:"POST",
                url : "/user/checkLogin",
                success : function(result) {
                    if (result.code==0) {
                        $.ajax({
                            type:"POST",
                            url:"/order/add/"+goodsId,
                            dataType:"json",
                            contentType:"application/json",
                            success : function(result) {
                                console.log(result)
                                if (result.code == 0) {
                                    showTip("已添加至购物车！");
                                }
                                else {
                                    showTip("请先登录");
                                }
                            }
                        });
                    } else {
                        showTip("请先登录！");
                    }
                }
            });

        //ajax代码实现

    })

    // $('.cart-add').click(function(event) {
    //     console.log($(event.target).attr("goodsId"));
    //     var goodsId=$(event.target).attr("goodsId")
    //     //检查用户是否登录
    //     $.ajax({
    //         type:"POST",
    //         url : "/user/checkLogin",
    //         success : function(result) {
    //             if (result.code==0) {
    //                 $.ajax({
    //                     type:"POST",
    //                     url:"/cart/addCartNow",
    //                     dataType:"json",
    //                     contentType:"application/json",
    //                     success : function(result) {
    //                         console.log(result)
    //                         if (result.code == 0) {
    //                             showTip("已添加至购物车！");
    //                         }
    //                         else {
    //                             showTip("请先登录");
    //                         }
    //                     }
    //                 });
    //             } else {
    //                 showTip("请先登录！");
    //             }
    //         }
    //     });
    //
    //     //ajax代码实现
    //
    // })

</script>
</body>
</html>
